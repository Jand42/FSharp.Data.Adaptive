<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>FSharp.Data.Adaptive : on demand adaptive/incremental data for F#
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="On-demand adaptive/incremental data for F#"/>
    <meta name="author" content="Georg Haaser, Don Syme"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="https://fsprojects.github.io/FSharp.Data.Adaptive/content/style.css" />
    <script type="text/javascript" src="https://fsprojects.github.io/FSharp.Data.Adaptive/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/fsprojects/FSharp.Data.Adaptive">github page</a></li>
        </ul>
        <h3 class="muted"><a href="https://fsprojects.github.io/FSharp.Data.Adaptive/index.html">FSharp.Data.Adaptive</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="FSharp-Data-Adaptive-on-demand-adaptive-incremental-data-for-F" class="anchor" href="#FSharp-Data-Adaptive-on-demand-adaptive-incremental-data-for-F">FSharp.Data.Adaptive : on demand adaptive/incremental data for F#</a></h1>
<p>FSharp.Data.Adaptive aims at providing simple, yet powerful tools for developers to
write incremental (or as we call it: adaptive) programs.
In contrast to RX or similar libraries adaptive focuses on values instead of events.
The most basic adaptive container-type we provide is <code>aval&lt;'T&gt;</code> and here's a little example of what it can do for you:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">Data</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">Adaptive</span>
</code></pre></td>
</tr>
</table>
<p>consider a falling ball that falls from <code>10m</code> heigh on earth (<code>9.81m/s^2</code>).</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="id">height</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="id">init</span> <span class="n">10.0</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="id">gravity</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="id">init</span> <span class="n">9.81</span>
</code></pre></td>
</tr>
</table>
<p>so when will the ball be hitting the floor?</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="id">timeToFloor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 11)" onmouseover="showTip(event, 'fs5', 11)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="id">map2</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="id">h</span> <span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="id">g</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="fn">sqrt</span> <span class="pn">(</span><span class="n">2.0</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="id">h</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs11', 17)" onmouseover="showTip(event, 'fs11', 17)" class="id">g</span><span class="pn">)</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs4', 18)" onmouseover="showTip(event, 'fs4', 18)" class="id">height</span> <span onmouseout="hideTip(event, 'fs7', 19)" onmouseover="showTip(event, 'fs7', 19)" class="id">gravity</span>
<span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">s&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 21)" onmouseover="showTip(event, 'fs5', 21)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="id">force</span> <span onmouseout="hideTip(event, 'fs8', 23)" onmouseover="showTip(event, 'fs8', 23)" class="id">timeToFloor</span><span class="pn">)</span> <span class="c">// =&gt; 1.428s</span>
</code></pre></td>
</tr>
</table>
<p>so how long will it take on the moon?</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 24)" onmouseover="showTip(event, 'fs15', 24)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 25)" onmouseover="showTip(event, 'fs7', 25)" class="id">gravity</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 26)" onmouseover="showTip(event, 'fs16', 26)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">1.62</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">s&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 28)" onmouseover="showTip(event, 'fs5', 28)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 29)" onmouseover="showTip(event, 'fs14', 29)" class="id">force</span> <span onmouseout="hideTip(event, 'fs8', 30)" onmouseover="showTip(event, 'fs8', 30)" class="id">timeToFloor</span><span class="pn">)</span> <span class="c">// =&gt; 3.514s</span>
</code></pre></td>
</tr>
</table>
<p>what about 2000m height on jupiter?</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 31)" onmouseover="showTip(event, 'fs15', 31)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs7', 32)" onmouseover="showTip(event, 'fs7', 32)" class="id">gravity</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 33)" onmouseover="showTip(event, 'fs16', 33)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">24.79</span>
    <span onmouseout="hideTip(event, 'fs4', 34)" onmouseover="showTip(event, 'fs4', 34)" class="id">height</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 35)" onmouseover="showTip(event, 'fs16', 35)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">2000.0</span>
<span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 36)" onmouseover="showTip(event, 'fs13', 36)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">s&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 37)" onmouseover="showTip(event, 'fs5', 37)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 38)" onmouseover="showTip(event, 'fs14', 38)" class="id">force</span> <span onmouseout="hideTip(event, 'fs8', 39)" onmouseover="showTip(event, 'fs8', 39)" class="id">timeToFloor</span><span class="pn">)</span> <span class="c">// =&gt; 12.703s</span>
</code></pre></td>
</tr>
</table>
<p>so currently this feels a lot like excel calcuations where dependent values get updated
whenever their inputs change which is not really impressive. The API becomes interesting when <strong>structural</strong> / <strong>dynamic</strong> dependencies
are needed.
So let's calculate the height where our ball will be at a certain point in time.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 40)" onmouseover="showTip(event, 'fs17', 40)" class="id">time</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 41)" onmouseover="showTip(event, 'fs5', 41)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs6', 42)" onmouseover="showTip(event, 'fs6', 42)" class="id">init</span> <span class="n">0.5</span>

<span class="c">// simple utility calculating the height</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 43)" onmouseover="showTip(event, 'fs18', 43)" class="fn">calcHeight</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs19', 44)" onmouseover="showTip(event, 'fs19', 44)" class="id">t</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs20', 45)" onmouseover="showTip(event, 'fs20', 45)" class="vt">float</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 46)" onmouseover="showTip(event, 'fs21', 46)" class="id">h0</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="vt">float</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs11', 48)" onmouseover="showTip(event, 'fs11', 48)" class="id">g</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs20', 49)" onmouseover="showTip(event, 'fs20', 49)" class="vt">float</span><span class="pn">)</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs22', 50)" onmouseover="showTip(event, 'fs22', 50)" class="fn">printf</span> <span class="s">&quot;height after </span><span class="pf">%.3f</span><span class="s">s: &quot;</span> <span onmouseout="hideTip(event, 'fs19', 51)" onmouseover="showTip(event, 'fs19', 51)" class="id">t</span>
    <span onmouseout="hideTip(event, 'fs21', 52)" onmouseover="showTip(event, 'fs21', 52)" class="id">h0</span> <span class="o">-</span> <span class="n">0.5</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs11', 53)" onmouseover="showTip(event, 'fs11', 53)" class="id">g</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs19', 54)" onmouseover="showTip(event, 'fs19', 54)" class="id">t</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs19', 55)" onmouseover="showTip(event, 'fs19', 55)" class="id">t</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 56)" onmouseover="showTip(event, 'fs23', 56)" class="id">currentHeight</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 57)" onmouseover="showTip(event, 'fs5', 57)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs24', 58)" onmouseover="showTip(event, 'fs24', 58)" class="id">map3</span> <span onmouseout="hideTip(event, 'fs18', 59)" onmouseover="showTip(event, 'fs18', 59)" class="fn">calcHeight</span> <span onmouseout="hideTip(event, 'fs17', 60)" onmouseover="showTip(event, 'fs17', 60)" class="id">time</span> <span onmouseout="hideTip(event, 'fs4', 61)" onmouseover="showTip(event, 'fs4', 61)" class="id">height</span> <span onmouseout="hideTip(event, 'fs7', 62)" onmouseover="showTip(event, 'fs7', 62)" class="id">gravity</span>
<span onmouseout="hideTip(event, 'fs13', 63)" onmouseover="showTip(event, 'fs13', 63)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 64)" onmouseover="showTip(event, 'fs5', 64)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 65)" onmouseover="showTip(event, 'fs14', 65)" class="id">force</span> <span onmouseout="hideTip(event, 'fs23', 66)" onmouseover="showTip(event, 'fs23', 66)" class="id">currentHeight</span><span class="pn">)</span> <span class="c">// height after 0.500s: 1996.901m</span>
</code></pre></td>
</tr>
</table>
<p>but what about invalid times (let's say -10s)?</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 67)" onmouseover="showTip(event, 'fs15', 67)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs17', 68)" onmouseover="showTip(event, 'fs17', 68)" class="id">time</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 69)" onmouseover="showTip(event, 'fs16', 69)" class="id">Value</span> <span class="k">&lt;-</span> <span class="o">-</span><span class="n">100.0</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 70)" onmouseover="showTip(event, 'fs13', 70)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 71)" onmouseover="showTip(event, 'fs5', 71)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 72)" onmouseover="showTip(event, 'fs14', 72)" class="id">force</span> <span onmouseout="hideTip(event, 'fs23', 73)" onmouseover="showTip(event, 'fs23', 73)" class="id">currentHeight</span><span class="pn">)</span> <span class="c">// =&gt; height after -100.000s: -121950.000m  </span>
</code></pre></td>
</tr>
</table>
<p>that's not really what we wanted!
so let's rewrite the code using a new combinator (namely <code>bind</code>)</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 74)" onmouseover="showTip(event, 'fs25', 74)" class="id">currentHeightNew</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs17', 75)" onmouseover="showTip(event, 'fs17', 75)" class="id">time</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 76)" onmouseover="showTip(event, 'fs5', 76)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs26', 77)" onmouseover="showTip(event, 'fs26', 77)" class="id">bind</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs19', 78)" onmouseover="showTip(event, 'fs19', 78)" class="id">t</span> <span class="k">-&gt;</span>
        <span class="k">if</span> <span onmouseout="hideTip(event, 'fs19', 79)" onmouseover="showTip(event, 'fs19', 79)" class="id">t</span> <span class="o">&lt;=</span> <span class="n">0.0</span> <span class="k">then</span> 
            <span class="c">// whenever the time is negative the ball will just report its initial height.</span>
            <span onmouseout="hideTip(event, 'fs4', 80)" onmouseover="showTip(event, 'fs4', 80)" class="id">height</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs27', 81)" onmouseover="showTip(event, 'fs27', 81)" class="if">aval</span><span class="pn">&lt;</span><span class="id">_</span><span class="pn">&gt;</span>
        <span class="k">else</span>
            <span class="c">// when the time is positive we use our utility to calculate the height.</span>
            <span onmouseout="hideTip(event, 'fs5', 82)" onmouseover="showTip(event, 'fs5', 82)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 83)" onmouseover="showTip(event, 'fs9', 83)" class="id">map2</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs18', 84)" onmouseover="showTip(event, 'fs18', 84)" class="fn">calcHeight</span> <span onmouseout="hideTip(event, 'fs19', 85)" onmouseover="showTip(event, 'fs19', 85)" class="id">t</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs4', 86)" onmouseover="showTip(event, 'fs4', 86)" class="id">height</span> <span onmouseout="hideTip(event, 'fs7', 87)" onmouseover="showTip(event, 'fs7', 87)" class="id">gravity</span>
    <span class="pn">)</span>
    
<span onmouseout="hideTip(event, 'fs13', 88)" onmouseover="showTip(event, 'fs13', 88)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 89)" onmouseover="showTip(event, 'fs5', 89)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 90)" onmouseover="showTip(event, 'fs14', 90)" class="id">force</span> <span onmouseout="hideTip(event, 'fs25', 91)" onmouseover="showTip(event, 'fs25', 91)" class="id">currentHeightNew</span><span class="pn">)</span> <span class="c">// =&gt; 2000.000m</span>
</code></pre></td>
</tr>
</table>
<p>that's better! NOTE that there is no <code>"height after"</code> print!
so what if we change the gravity back to earth?</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 92)" onmouseover="showTip(event, 'fs15', 92)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 93)" onmouseover="showTip(event, 'fs7', 93)" class="id">gravity</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 94)" onmouseover="showTip(event, 'fs16', 94)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">9.81</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 95)" onmouseover="showTip(event, 'fs13', 95)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 96)" onmouseover="showTip(event, 'fs5', 96)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 97)" onmouseover="showTip(event, 'fs14', 97)" class="id">force</span> <span onmouseout="hideTip(event, 'fs25', 98)" onmouseover="showTip(event, 'fs25', 98)" class="id">currentHeightNew</span><span class="pn">)</span> <span class="c">// =&gt; 2000.000m (still no computation)</span>
</code></pre></td>
</tr>
</table>
<p>okay, set the height to 10m again.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 99)" onmouseover="showTip(event, 'fs15', 99)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 100)" onmouseover="showTip(event, 'fs4', 100)" class="id">height</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 101)" onmouseover="showTip(event, 'fs16', 101)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">10.0</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 102)" onmouseover="showTip(event, 'fs13', 102)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 103)" onmouseover="showTip(event, 'fs5', 103)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 104)" onmouseover="showTip(event, 'fs14', 104)" class="id">force</span> <span onmouseout="hideTip(event, 'fs25', 105)" onmouseover="showTip(event, 'fs25', 105)" class="id">currentHeightNew</span><span class="pn">)</span> <span class="c">// 10.0m (still no computation)</span>
</code></pre></td>
</tr>
</table>
<p>so let's set the time to something positive again and see if the result will be correct.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs15', 106)" onmouseover="showTip(event, 'fs15', 106)" class="fn">transact</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs17', 107)" onmouseover="showTip(event, 'fs17', 107)" class="id">time</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 108)" onmouseover="showTip(event, 'fs16', 108)" class="id">Value</span> <span class="k">&lt;-</span> <span class="n">1.42785</span><span class="pn">)</span>
<span onmouseout="hideTip(event, 'fs13', 109)" onmouseover="showTip(event, 'fs13', 109)" class="fn">printfn</span> <span class="s">&quot;</span><span class="pf">%.3f</span><span class="s">m&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 110)" onmouseover="showTip(event, 'fs5', 110)" class="m">AVal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 111)" onmouseover="showTip(event, 'fs14', 111)" class="id">force</span> <span onmouseout="hideTip(event, 'fs25', 112)" onmouseover="showTip(event, 'fs25', 112)" class="id">currentHeightNew</span><span class="pn">)</span> <span class="c">// height after 1.428s: 0.000m</span>
</code></pre></td>
</tr>
</table>
<p>What this simple example demonstrates is that <code>aval&lt;'T&gt;</code> is capable of expressing <strong>dynamic</strong> dependency graphs.
The system <em>knows</em> that the resulting value doesn't depend on gravity/height as long as the current time is negative but still can compute the
correct result once the time gets positive again. This may seem trivial at a first glance but this kind of dependency
cannot be expressed in traditional reactive-programming libraries.</p>

<div class="tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs2">Multiple items<br />namespace FSharp.Data<br /><br />--------------------<br />namespace Microsoft.FSharp.Data</div>
<div class="tip" id="fs3">namespace FSharp.Data.Adaptive</div>
<div class="tip" id="fs4">val height : cval&lt;float&gt;</div>
<div class="tip" id="fs5">module AVal<br /><br />from FSharp.Data.Adaptive</div>
<div class="tip" id="fs6">val init : value:&#39;T -&gt; cval&lt;&#39;T&gt;</div>
<div class="tip" id="fs7">val gravity : cval&lt;float&gt;</div>
<div class="tip" id="fs8">val timeToFloor : aval&lt;float&gt;</div>
<div class="tip" id="fs9">val map2 : mapping:(&#39;T1 -&gt; &#39;T2 -&gt; &#39;T3) -&gt; value1:aval&lt;&#39;T1&gt; -&gt; value2:aval&lt;&#39;T2&gt; -&gt; aval&lt;&#39;T3&gt;</div>
<div class="tip" id="fs10">val h : float</div>
<div class="tip" id="fs11">val g : float</div>
<div class="tip" id="fs12">val sqrt : value:&#39;T -&gt; &#39;U (requires member Sqrt)</div>
<div class="tip" id="fs13">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs14">val force : value:aval&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs15">val transact : f:(unit -&gt; &#39;T) -&gt; &#39;T</div>
<div class="tip" id="fs16">property ChangeableValue.Value: float</div>
<div class="tip" id="fs17">val time : cval&lt;float&gt;</div>
<div class="tip" id="fs18">val calcHeight : t:float -&gt; h0:float -&gt; g:float -&gt; float</div>
<div class="tip" id="fs19">val t : float</div>
<div class="tip" id="fs20">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />--------------------<br />type float = System.Double<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float</div>
<div class="tip" id="fs21">val h0 : float</div>
<div class="tip" id="fs22">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T</div>
<div class="tip" id="fs23">val currentHeight : aval&lt;float&gt;</div>
<div class="tip" id="fs24">val map3 : mapping:(&#39;T1 -&gt; &#39;T2 -&gt; &#39;T3 -&gt; &#39;T4) -&gt; value1:aval&lt;&#39;T1&gt; -&gt; value2:aval&lt;&#39;T2&gt; -&gt; value3:aval&lt;&#39;T3&gt; -&gt; aval&lt;&#39;T4&gt;</div>
<div class="tip" id="fs25">val currentHeightNew : aval&lt;float&gt;</div>
<div class="tip" id="fs26">val bind : mapping:(&#39;T1 -&gt; aval&lt;&#39;T2&gt;) -&gt; value:aval&lt;&#39;T1&gt; -&gt; aval&lt;&#39;T2&gt;</div>
<div class="tip" id="fs27">Multiple items<br />val aval : AValBuilder<br /><br />--------------------<br />type aval&lt;&#39;T&gt; = AdaptiveValue&lt;&#39;T&gt;</div>

        </div>
        <div class="span3">
          <a target="_blank" href="https://fsprojects.github.io/FSharp.Data.Adaptive">
      <img src="https://fsprojects.github.io/FSharp.Data.Adaptive/img/logo.png" alt="F# Project" style="width:150px;margin:10px" /> 
      </a>
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">FSharp.Data.Adaptive</li>
            <li><a href="https://fsprojects.github.io/FSharp.Data.Adaptive/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://www.nuget.org/packages/FSharp.Data.Adaptive">Get Library via NuGet</a></li>
            <li><a href="http://github.com/fsprojects/FSharp.Data.Adaptive">Source Code on GitHub</a></li>
            <li><a href="http://github.com/fsprojects/FSharp.Data.Adaptive/blob/master/LICENSE">License</a></li>
            <li><a href="http://github.com/fsprojects/FSharp.Data.Adaptive/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="https://fsprojects.github.io/FSharp.Data.Adaptive/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsprojects/FSharp.Data.Adaptive"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
